<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="Contollers.MenuController"
            prefHeight="700.0" prefWidth="1000.0"
            stylesheets="@menu.css">

    <!-- ============ TOP SECTION ============ -->
    <top>
        <VBox>
            <MenuBar styleClass="menu-bar">
                <Menu text="Fichier">
                    <MenuItem text="DÃ©connexion" onAction="#handleLogout"/>
                    <MenuItem text="Quitter"/>
                </Menu>
            </MenuBar>

            <HBox styleClass="top-bar">
                <Label text="ðŸ‹ï¸ SYSTÃˆME DE GESTION DE SALLE DE GYM"
                       styleClass="header-title"/>
            </HBox>
        </VBox>
    </top>

    <!-- ============ CENTER : ALL TABS ============ -->
    <center>
        <TabPane fx:id="mainTabPane" tabClosingPolicy="UNAVAILABLE" styleClass="tab-pane">

            <!-- ============ TAB MEMBRES ============ -->
            <Tab text="ðŸ‘¥ Membres">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des Membres" styleClass="section-title"/>

                    <GridPane hgap="10" vgap="10">
                        <TextField fx:id="membreNomField" promptText="Nom" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <TextField fx:id="membrePrenomField" promptText="PrÃ©nom" GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                        <TextField fx:id="membreEmailField" promptText="Email" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <TextField fx:id="membreTelField" promptText="TÃ©lÃ©phone" GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                    </GridPane>

                    <HBox spacing="10">
                        <Button text="âž• Ajouter" onAction="#handleAjouterMembre" styleClass="btn-green"/>
                        <Button text="ðŸ—‘ï¸ Supprimer" onAction="#handleSupprimerMembre" styleClass="btn-red"/>
                        <Button text="Membres Actifs" onAction="#handleAfficherMembresActifs"/>
                        <Button text="Afficher Membres" onAction="#handleAfficherMembres"/>
                    </HBox>

                    <TableView fx:id="membresTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="membreIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="membreNomCol" text="Nom Complet" prefWidth="250"/>
                            <TableColumn fx:id="membreEmailCol" text="Email" prefWidth="250"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB COACHS ============ -->
            <Tab text="ðŸƒ Coachs">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des Coachs" styleClass="section-title"/>

                    <GridPane hgap="10" vgap="10">
                        <TextField fx:id="coachNomField" promptText="Nom" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <TextField fx:id="coachPrenomField" promptText="PrÃ©nom" GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                        <TextField fx:id="coachEmailField" promptText="Email" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <TextField fx:id="coachTelField" promptText="TÃ©lÃ©phone" GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                        <TextField fx:id="coachSpecialiteField" promptText="SpÃ©cialitÃ©" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                        <TextField fx:id="coachTarifField" promptText="Tarif horaire" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                    </GridPane>

                    <HBox spacing="10">
                        <Button text="âž• Ajouter" onAction="#handleAjouterCoach" styleClass="btn-green"/>
                        <Button text="ðŸ—‘ï¸ Supprimer" onAction="#handleSupprimerCoach" styleClass="btn-red"/>
                    </HBox>

                    <TableView fx:id="coachsTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="coachIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="coachNomCol" text="Nom Complet" prefWidth="400"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB MANAGERS ============ -->
            <Tab text="ðŸ’¼ Managers">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des Managers" styleClass="section-title"/>

                    <GridPane hgap="10" vgap="10">
                        <TextField fx:id="managerNomField" promptText="Nom" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <TextField fx:id="managerPrenomField" promptText="PrÃ©nom" GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                        <TextField fx:id="managerEmailField" promptText="Email" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <TextField fx:id="managerTelField" promptText="TÃ©lÃ©phone" GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                        <TextField fx:id="managerLoginField" promptText="Login" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                        <PasswordField fx:id="managerPasswordField" promptText="Mot de passe" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                    </GridPane>

                    <HBox spacing="10">
                        <Button text="âž• Ajouter" onAction="#handleAjouterManager" styleClass="btn-green"/>
                        <Button text="ðŸ—‘ï¸ Supprimer" onAction="#handleSupprimerManager" styleClass="btn-red"/>
                    </HBox>

                    <TableView fx:id="managersTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="managerIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="managerNomCol" text="Nom Complet" prefWidth="400"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB SALLES ============ -->
            <Tab text="ðŸ¢ Salles">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des Salles" styleClass="section-title"/>

                    <HBox spacing="10">
                        <TextField fx:id="nomSalleField" promptText="Nom de la salle" prefWidth="200"/>
                        <TextField fx:id="capaciteSalleField" promptText="CapacitÃ©" prefWidth="100"/>
                        <Button text="âž• CrÃ©er" onAction="#handleCreerSalle" styleClass="btn-green"/>
                        <Button text="ðŸ—‘ï¸ Supprimer" onAction="#handleSupprimerSalle" styleClass="btn-red"/>
                    </HBox>

                    <TableView fx:id="sallesTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="salleIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="salleNomCol" text="Nom" prefWidth="300"/>
                            <TableColumn fx:id="salleCapaciteCol" text="CapacitÃ©" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB Ã‰QUIPEMENTS ============ -->
            <Tab text="ðŸ”§ Ã‰quipements">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des Ã‰quipements" styleClass="section-title"/>

                    <HBox spacing="10">
                        <TextField fx:id="nomEquipField" promptText="Nom Ã©quipement" prefWidth="200"/>
                        <ComboBox fx:id="etatEquipComboBox" promptText="Ã‰tat" prefWidth="150"/>
                        <Button text="âž• Ajouter" onAction="#handleAjouterEquipement" styleClass="btn-green"/>
                        <Button text="ðŸ—‘ï¸ Supprimer" onAction="#handleSupprimerEquipement" styleClass="btn-red"/>
                        <Button text="Ã‰quipements Fonctionnels" onAction="#handleAfficherEquipementsFonctionnels"/>
                        <Button text="Afficher Ã‰quipements" onAction="#handleAfficherEquipements"/>
                    </HBox>

                    <HBox spacing="10">
                        <Label text="Affecter Ã  une salle:"/>
                        <ComboBox fx:id="equipSalleComboBox" promptText="SÃ©lectionner salle" prefWidth="150"/>
                        <Button text="âœ“ Affecter" onAction="#handleAffecterEquipementSalle" styleClass="btn-blue"/>
                    </HBox>

                    <TableView fx:id="equipementsTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="equipIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="equipNomCol" text="Nom" prefWidth="250"/>
                            <TableColumn fx:id="equipEtatCol" text="Ã‰tat" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB ABONNEMENTS ============ -->
            <Tab text="ðŸ’³ Abonnements">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des Abonnements" styleClass="section-title"/>

                    <HBox spacing="10">
                        <ComboBox fx:id="membreAbonnementComboBox" promptText="Membre" prefWidth="200"/>
                        <ComboBox fx:id="typeAbonnementComboBox" promptText="Type" prefWidth="200"/>
                        <Label fx:id="prixAbonnementLabel" text="Prix: --" styleClass="section-subtitle"/>
                        <Button text="âž• CrÃ©er" onAction="#handleCreerAbonnement" styleClass="btn-green"/>
                        <Button text="ðŸ“‹ Afficher" onAction="#handleAfficherAbonnements" styleClass="btn-blue"/>
                    </HBox>

                    <TableView fx:id="abonnementsTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="aboMembreCol" text="Membre" prefWidth="200"/>
                            <TableColumn fx:id="aboTypeCol" text="Type" prefWidth="120"/>
                            <TableColumn fx:id="aboDebutCol" text="DÃ©but" prefWidth="120"/>
                            <TableColumn fx:id="aboFinCol" text="Fin" prefWidth="120"/>
                            <TableColumn fx:id="aboValideCol" text="Valide" prefWidth="100"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB PAIEMENTS ============ -->
            <Tab text="ðŸ’° Paiements">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des Paiements" styleClass="section-title"/>

                    <HBox spacing="10">
                        <ComboBox fx:id="membrePaiementComboBox" promptText="Membre" prefWidth="200"/>
                        <ComboBox fx:id="typePaiementComboBox" promptText="Type" prefWidth="150"/>
                        <TextField fx:id="montantPaiementField" promptText="Montant (DT)" prefWidth="120"/>
                        <Button text="ðŸ’³ Effectuer" onAction="#handleEffectuerPaiement" styleClass="btn-green"/>
                    </HBox>

                    <TableView fx:id="paiementsTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="paiementIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="paiementMembreCol" text="Membre" prefWidth="200"/>
                            <TableColumn fx:id="paiementTypeCol" text="Type" prefWidth="150"/>
                            <TableColumn fx:id="paiementMontantCol" text="Montant" prefWidth="120"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB SÃ‰ANCES ============ -->
            <Tab text="ðŸ‹ï¸ SÃ©ances">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des SÃ©ances" styleClass="section-title"/>

                    <GridPane hgap="10" vgap="10">
                        <ComboBox fx:id="typeSeanceComboBox" promptText="Type" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <ComboBox fx:id="salleSeanceComboBox" promptText="Salle" GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                        <ComboBox fx:id="coachSeanceComboBox" promptText="Coach" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <ComboBox fx:id="membreSeanceComboBox" promptText="Membre" GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                        <TextField fx:id="dateSeanceField" promptText="Date (jj/mm/aaaa)" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                        <TextField fx:id="dureeSeanceField" promptText="DurÃ©e (heures)" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                        <TextField fx:id="coutSeanceField" promptText="CoÃ»t (DT)" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                        <TextField fx:id="capaciteSeanceField" promptText="CapacitÃ©" GridPane.columnIndex="1" GridPane.rowIndex="3"/>
                    </GridPane>

                    <Button text="âž• CrÃ©er SÃ©ance" onAction="#handleCreerSeance" styleClass="btn-green"/>

                    <TableView fx:id="seancesTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="seanceIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="seanceTypeCol" text="Type" prefWidth="150"/>
                            <TableColumn fx:id="seanceDateCol" text="Date" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB PROGRAMMES ============ -->
            <Tab text="ðŸ“‹ Programmes">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Programmes d'EntraÃ®nement" styleClass="section-title"/>

                    <HBox spacing="10">
                        <ComboBox fx:id="coachProgrammeComboBox" promptText="Coach" prefWidth="200"/>
                        <TextField fx:id="titreProgrammeField" promptText="Titre du programme" prefWidth="250"/>
                        <Button text="âž• CrÃ©er Programme" onAction="#handleCreerProgramme" styleClass="btn-green"/>
                    </HBox>

                    <Separator/>

                    <Label text="Ajouter un exercice" styleClass="section-subtitle"/>
                    <GridPane hgap="10" vgap="10">
                        <TextField fx:id="nomExerciceField" promptText="Nom exercice" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <TextField fx:id="repetitionsField" promptText="RÃ©pÃ©titions" GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                        <TextField fx:id="poidsField" promptText="Poids (kg)" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <TextField fx:id="dureeExerciceField" promptText="DurÃ©e (min)" GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                    </GridPane>

                    <Button text="âž• Ajouter Exercice" onAction="#handleAjouterExercice" styleClass="btn-blue"/>

                    <TableView fx:id="programmesTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="progIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="progTitreCol" text="Titre" prefWidth="400"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB RÃ‰SERVATIONS ============ -->
            <Tab text="ðŸ“… RÃ©servations">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <Label text="Gestion des RÃ©servations" styleClass="section-title"/>

                    <HBox spacing="10">
                        <ComboBox fx:id="membreReservationComboBox" promptText="Membre" prefWidth="200"/>
                        <ComboBox fx:id="seanceReservationComboBox" promptText="SÃ©ance" prefWidth="300"/>
                        <Button text="âž• RÃ©server" onAction="#handleCreerReservation" styleClass="btn-green"/>
                    </HBox>

                    <HBox spacing="10">
                        <Button text="âœ“ Confirmer" onAction="#handleConfirmerReservation" styleClass="btn-blue"/>
                        <Button text="âœ— Annuler" onAction="#handleAnnulerReservation" styleClass="btn-red"/>
                    </HBox>

                    <TableView fx:id="reservationsTable" VBox.vgrow="ALWAYS" styleClass="table-modern">
                        <columns>
                            <TableColumn fx:id="resIdCol" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="resMembreCol" text="Membre" prefWidth="200"/>
                            <TableColumn fx:id="resSeanceCol" text="SÃ©ance" prefWidth="300"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- ============ TAB STATISTIQUES ============ -->
            <Tab text="ðŸ“Š Statistiques">
                <VBox spacing="20" style="-fx-padding: 20;">
                    <Label text="Statistiques GÃ©nÃ©rales" styleClass="section-title"/>

                    <HBox spacing="20">
                        <VBox spacing="5" styleClass="stats-card">
                            <Label text="ðŸ’µ Revenu"/>
                            <Label fx:id="revenuTotalLabel" text="0.00 DT" styleClass="stats-value-green"/>
                        </VBox>
                        <VBox spacing="5" styleClass="stats-card">
                            <Label text="ðŸ’¸ DÃ©penses"/>
                            <Label fx:id="depenseTotalLabel" text="0.00 DT" styleClass="stats-value-red"/>
                        </VBox>
                        <VBox spacing="5" styleClass="stats-card">
                            <Label text="ðŸ“ˆ BÃ©nÃ©fice"/>
                            <Label fx:id="beneficeNetLabel" text="0.00 DT" styleClass="stats-value"/>
                        </VBox>
                        <VBox spacing="5" styleClass="stats-card">
                            <Label text="ðŸ‘¥ Membres"/>
                            <Label fx:id="nombreMembresLabel" text="0" styleClass="stats-value"/>
                        </VBox>
                        <VBox spacing="5" styleClass="stats-card">
                            <Label text="ðŸ‹ï¸ SÃ©ances"/>
                            <Label fx:id="nombreSeancesLabel" text="0" styleClass="stats-value"/>
                        </VBox>
                    </HBox>

                    <Button text="ðŸ”„ Calculer" onAction="#handleCalculerStatistiques" styleClass="btn-blue"/>

                    <TextArea fx:id="statsDetailsArea" VBox.vgrow="ALWAYS" editable="false" styleClass="stats-text"/>
                </VBox>
            </Tab>

        </TabPane>
    </center>

    <!-- ============ FOOTER ============ -->
    <bottom>
        <HBox styleClass="footer">
            <Label fx:id="messageLabel" text="âœ… Bienvenue !"/>
        </HBox>
    </bottom>

</BorderPane>